<div class="container admin-container">
  <h1 class="page-title">Gestion des utilisateurs</h1>

  <div class="search-controls card">
    <input [(ngModel)]="searchQuery" class="text-input" placeholder="Rechercher par nom ou email">
    <button class="btn-primary search-btn" (click)="search()">Rechercher</button>
  </div>

  <section class="user-list-card card">
    <table class="user-table">
      <thead>
      <tr>
        <th>Username</th>
        <th>Email</th>
        <th class="role-header">Rôle</th>
      </tr>
      </thead>
      <tbody>
        @for (user of users; track user.id) {
          <tr>
            <td class="username-cell">{{ user.username }}</td>
            <td class="email-cell">{{ user.email }}</td>
            <td class="role-cell">
              <select class="role-select" [value]="user.role" (change)="changeRole(user, $event)">
                <option value="USER">USER</option>
                <option value="ADMIN">ADMIN</option>
              </select>
            </td>
          </tr>
        }
        @empty {
          <tr>
            <td colspan="3" class="no-users-msg">Aucun utilisateur trouvé.</td>
          </tr>
        }
      </tbody>
    </table>
  </section>

  <div class="pagination-controls">
    <button
      class="btn-secondary"
      (click)="prevPage()"
      [disabled]="currentPage === 0"
    >
      ← Précédent
    </button>

    <span class="current-page-display">Page {{ currentPage + 1 }}</span>

    <button
      class="btn-secondary"
      (click)="nextPage()"
      [disabled]="!hasMorePages"
    >
      Suivant →
    </button>
  </div>
</div>
